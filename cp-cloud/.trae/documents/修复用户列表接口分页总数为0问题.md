## 问题结论

* 返回结构的 `total=0` 是因为后端使用 MyBatis-Plus 的 `selectPage` 分页，但项目未注册分页拦截器，导致未执行统计 SQL，`page.getTotal()` 始终为 0。

* 证据：

  * 控制器分页返回走 `getDataTable(IPage<?>)`，总数取自 `page.getTotal()`：`cp-common/cp-common-core/src/main/java/com/cp/common/core/web/controller/BaseController.java:86-97`

  * 用户列表接口使用 MP 分页：`cp-modules/cp-system/src/main/java/com/cp/system/controller/SysUserController.java:51-55`

  * 构建分页对象：`PageUtils.buildPage()` 仅创建 `Page<T>`，未配置统计/拦截：`cp-common/cp-common-core/src/main/java/com/cp/common/core/utils/PageUtils.java:25-38`

  * 仓库中未找到 `MybatisPlusInterceptor/PaginationInnerInterceptor` 注册。

## 修复方案

1. 在公共配置模块（推荐：`cp-common`）或系统模块 `cp-modules/cp-system` 新增 MyBatis-Plus 配置类，注册分页拦截器：

   * 创建 `MybatisPlusConfig`，内容：

     ```java
     @Configuration
     public class MybatisPlusConfig {
       @Bean
       public MybatisPlusInterceptor mybatisPlusInterceptor() {
         MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
         PaginationInnerInterceptor pii = new PaginationInnerInterceptor(DbType.MYSQL);
         pii.setOverflow(true);      // 页码越界回首页（可选）
         pii.setMaxLimit(1000L);     // 单页最大行数（可选）
         interceptor.addInnerInterceptor(pii);
         return interceptor;
       }
     }
     ```

   * 放置位置建议：`cp-common`（让所有使用 MP 的模块复用），或临时在 `cp-modules/cp-system` 生效后再推广。

2. 保持现有控制器与服务实现不变：

   * 控制器继续使用：`return getDataTable(userService.selectUserPage(user));`（`cp-modules/cp-system/src/main/java/com/cp/system/controller/SysUserController.java:53-55`）

   * 服务层分页实现：`PageUtils.buildPage()` + `baseMapper.selectPage(page, qw)`（`cp-modules/cp-system/src/main/java/com/cp/system/service/impl/SysUserServiceImpl.java:79-96`）

3. 前端请求校验（非必需但建议）：

   * 确认请求参数包含 `pageNum`、`pageSize`（由 `TableSupport.getPageDomain()` 读取：`cp-common/cp-common-core/src/main/java/com/cp/common/core/web/page/TableSupport.java:34-49`）。

## 验证步骤

* 启动系统后调用 `GET /system/user/list?pageNum=1&pageSize=10`。

* 期望：`rows` 正常返回数据，同时 `total` 为数据库中符合条件的总记录数（>0）。

## 备选与说明

* 若暂不启用拦截器：可临时改用非分页查询并返回 `getDataTable(List<?>)`，但此时 `total` 为当前返回条数而非全量总数，不满足分页展示需求。

* 数据范围切面 `@DataScope` 未应用于 `selectUserPage`，不会拦截当前列表（证据：`cp-modules/cp-system/src/main/java/com/cp/system/service/impl/SysUserServiceImpl.java:52-77,79-96`）。如需数据范围，请在分页方法上增加注解并在

