## 目标与返回契约
- 面向角色管理卡片视图，提供 `GET /role/cards`（网关路径建议 `/system/role/cards`）。
- 返回每个角色：`id`、`name`、`desc`、`tags`、`badgeColor`、`cardBgColor`、`cardBorderColor`。

## 兼容你已修改的 role 表
- 若你已在 `sys_role` 增加了样式字段：`badge_color`、`card_bg_color`、`card_border_color`，直接映射至 VO；缺失则按算法生成（见下节）。
- 若你为 `desc` 单独建列（或沿用 `remark`）：优先读该列；否则读 `remark`（BaseEntity）。
- 若你新增了 `tags` 字段：
  - 如果为冗余缓存（JSON/逗号分隔字符串），优先读该列；为空时回落到菜单聚合（`sys_role_menu` → `sys_menu.menu_name`）。
  - 如果未新增该列（推荐避免把数组直接持久化），统一从菜单聚合生成。

## 现有代码与位置
- 角色实体：`cp-api/cp-api-system/src/main/java/com/cp/system/api/domain/SysRole.java`（需要扩展颜色/desc/tags字段映射）
- 菜单实体：`cp-modules/cp-system/src/main/java/com/cp/system/domain/SysMenu.java`
- Mapper XML：
  - 角色：`cp-modules/cp-system/src/main/resources/mapper/system/SysRoleMapper.xml`
  - 菜单：`cp-modules/cp-system/src/main/resources/mapper/system/SysMenuMapper.xml`
- 控制器：`cp-modules/cp-system/src/main/java/com/cp/system/controller/SysRoleController.java`

## 实体与 Mapper 修改（适配新列）
- `SysRole` 新增（如你的表已包含）：
  - `private String badgeColor;`
  - `private String cardBgColor;`
  - `private String cardBorderColor;`
  - `private String desc;`（若你单独建列；否则沿用 `remark`）
  - `private List<String> tags;`（仅当你决定持久化；否则不加）
- `SysRoleMapper.xml` 的 `selectRoleVo/insertRole/updateRole`：加入上述列的 `select` 与 `set/values` 映射；列名按你的实际命名（例如 `badge_color`）。

## 菜单名称聚合作为 tags
- 在 `SysMenuMapper.xml` 新增：
  - `select distinct m.menu_name from sys_menu m left join sys_role_menu rm on m.menu_id = rm.menu_id where rm.role_id = #{roleId} and m.status = '0' and m.menu_type in ('M','C')`
- 在 `SysMenuMapper` 新增对应接口：`List<String> selectMenuNamesByRoleId(Long roleId)`。

## VO 定义
- `RoleCardVO`（`cp-modules/cp-system/src/main/java/com/cp/system/vo/RoleCardVO.java`）：
  - `Long id, String name, String desc, List<String> tags, String badgeColor, String cardBgColor, String cardBorderColor`。

## 服务层实现（兼容策略）
- 在 `ISysRoleService` 增加：`List<RoleCardVO> listRoleCards()`。
- `SysRoleServiceImpl.listRoleCards()` 逻辑：
  - 读取角色列表（`selectRoleAll()` 或带条件分页）。
  - 对每个角色：
    - `name/id/desc`：优先使用你新增列，其次使用现有 `roleName/roleId/remark`。
    - `tags`：
      - 若你持久化了 `tags` 且非空：解析为 `List<String>`。
      - 否则：调用 `SysMenuMapper.selectMenuNamesByRoleId()` 聚合菜单名称。
    - 颜色：
      - 若 `badge_color` 等列存在且非空：直接使用。
      - 否则：按 `roleKey` 稳定生成（见下节）。
  - 返回 `RoleCardVO` 列表。

## 控制器实现
- 在 `SysRoleController` 增加：
  - `@GetMapping("/cards")`
  - `@RequiresPermissions("system:role:list")`（可按你的页面权限调整）。
  - 返回 `R.ok(roleService.listRoleCards())`。

## 颜色生成算法（列为空时）
- 预置调色板数组，按 `hash(roleKey) % N` 稳定取色。
- 特例映射：`roleKey == 'admin'`（或 `roleName == '超级管理员'`）→ `#4E9F3D/#F0F7F2/#D9EAD3`，以匹配你的样例。

## 性能与可维护性
- 角色很多时支持分页与批量聚合菜单名称（`role_id in (...)`）减少 N 次查询。
- 避免把 `tags` 作为真源头写入库（推荐只缓存）；真源头仍来自 `sys_role_menu` 关系，以免权限与展示脱节。

## 网关与调用
- 网关 `cp-gateway` 已接入 Nacos（application.yml:25-27）；常规 `spring.cloud.gateway.routes` 会将 `/system/**` 代理到 `cp-system`。无需额外改动。

## 示例响应
```json
{
  "id": 1,
  "name": "超级管理员",
  "desc": "拥有系统所有权限",
  "tags": ["用户管理", "角色管理", "系统设置", "数据报表"],
  "badgeColor": "#4E9F3D",
  "cardBgColor": "#F0F7F2",
  "cardBorderColor": "#D9EAD3"
}
```

## 下一步
- 我将按照上述兼容方案：扩展实体/Mapper（基于你已增加的列名）、新增菜单名称查询、实现服务与控制器，并提供稳定颜色生成与必要的单元测试。请确认是否使用“持久化颜色字段”和“（可选）持久化 tags 字段”两项；若确认，我将开始具体实现。